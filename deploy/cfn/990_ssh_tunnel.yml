# Code generated by Makefile. DO NOT EDIT.

AWSTemplateFormatVersion: '2010-09-09'
Transform: AWS::Serverless-2016-10-31
Parameters:
  Prefix:
    Type: String
  Env:
    Type: String
  SubnetPubA:
    Type: String
  SecurityGroupSshTunnel:
    Type: String
  ImageIdAmazonLinux:
    Type: AWS::SSM::Parameter::Value<AWS::EC2::Image::Id>
    Default: /aws/service/ami-amazon-linux-latest/al2023-ami-kernel-6.1-x86_64
Resources:
  InstanceSshTunnel:
    Type: AWS::EC2::Instance
    Properties:
      ImageId:
        Ref: ImageIdAmazonLinux
      InstanceType: t3.micro
      KeyName:
        Ref: KeyPairSshTunnel
      SubnetId:
        Ref: SubnetPubA
      SecurityGroupIds:
        - Ref: SecurityGroupSshTunnel
      Tags:
        - Key: Name
          Value:
            Fn::Sub: ${Prefix}-SshTunnel
  EipAssociationEipSshTunnel:
    Type: AWS::EC2::EIPAssociation
    Properties:
      AllocationId:
        Fn::GetAtt: EipSshTunnel.AllocationId
      InstanceId:
        Ref: InstanceSshTunnel
  EipSshTunnel:
    Type: AWS::EC2::EIP
    Properties:
      Domain: vpc
  KeyPairSshTunnel:
    Type: AWS::EC2::KeyPair
    Properties:
      KeyName:
        Fn::Sub: ${Prefix}-SshTunnel-${AWS::AccountId}
Outputs:
  InstanceSshTunnel:
    Value:
      Ref: InstanceSshTunnel
    Export:
      Name:
        Fn::Sub: ${Prefix}-InstanceSshTunnel
  EipSshTunnel:
    Value:
      Ref: EipSshTunnel
    Export:
      Name:
        Fn::Sub: ${Prefix}-EipSshTunnel
  KeyPairSshTunnel:
    Value:
      Ref: KeyPairSshTunnel
    Export:
      Name:
        Fn::Sub: ${Prefix}-KeyPairSshTunnel
  KeyPairSshTunnelId:
    Value:
      Fn::GetAtt: KeyPairSshTunnel.KeyPairId
    Export:
      Name:
        Fn::Sub: ${Prefix}-KeyPairSshTunnelId
